<!-- ************************ -->
<!-- CUSTOMERS -->
<!-- *********************** -->
<div ui-view class="users" ng-controller="customersCtrl">
    <div class="content-header">
        <div ng-click="back()" ng-show="searchIsOn" class="row back-btn pull-left">
            <img src="images/Buttons/arrow-back.png" alt="Back to customers">Customers
        </div>
        <span class="pull-right">
                <div id="custom-search-input">
                    <div class="input-group">
                        <form>
                            <input type="search" class="form-control"  ng-model='searchkey' placeholder="Search">
                            <span class="input-group-btn">
                                 <button class="btn btn-info" type="submit" ng-click="searchCustomers(true, searchkey)">
                                       <i class="glyphicon glyphicon-search"></i>
                                 </button>
                            </span>
                        </form>
                     </div>
                </div>
        </span>
<span class="pull-right">
          <label for="sel1">SORT BY </label>
            <select class="custom-select" ng-options="sort.name for sort in sorts" 
             ng-model="selectedSort">
             </select>   
        </span>

        <div class="col-sm-5">
            <span class="glyphicon glyphicon-envelope send-message pull-right" ng-click="BroadcastCustomer()" title="Broadcast" style="color:#FF4081;font-size:20px;cursor:pointer;"> </span>
        </div>
</div>
<div class="clearfix"></div>
<h3 ng-show="noData">Uh oh! we do not have any Customer.</h3>
<div id="mainbox" ng-style="style()" resize>
    <div class="user-card" ng-class="{banned: customer.isban}" ui-sref="homepage.customer-detail({customerId:customer._id})" ng-repeat="customer in customers |  orderBy:selectedSort.key:selectedSort.reverse">
        <div class="card-header">BANNED</div>
        <div class="card-top">
            <img ng-show="customer.thumb_image" ng-src="{{CustomImgUrl + customer.external_user_identifiers[0].image_uri}}">
            <img ng-show="!customer.thumb_image" ng-src="{{customer.external_user_identifiers[0].image_uri}}">
            <!-- <img ng-src="{{customer.external_user_identifiers[0].image_uri}}"> -->
            <div class="name-time-wrap">
                <div class="user-name"> {{customer.name | limitTo : 24}}</div>
               <div class="last-active" ng-if="customer.lastlogin"> {{customer.lastlogin|date:'h:mma MM/dd/yyyy'}}</div>
                 <div class="last-active" ng-if="!customer.lastlogin"> New User</div>
            </div>
        </div>
        <div class="wrap-user-stats">
            <div class="col-sm-10 no-padding">
                <div class="hired">JOBS HIRED
                    <span>{{customer.jobs.completed}}</span>
                </div>
                <div class="declined">CANCELED
                    <span>{{customer.jobs.cancelled }}</span>
                </div>
            </div>
            <div class="col-sm-2 no-padding">
                <div class="message" ng-show="customer.electronic_addresses.length>1">
                   <span class="glyphicon glyphicon-envelope send-message pull-right" ng-click="MessageCustomer(customer.electronic_addresses[1].value, customer.country_code, customer._id)" title="Broadcast" style="color:#FF4081;font-size:20px;cursor:pointer;"> </span>
                </div>
            </div>
        </div>
        <div class="clearfix"></div>
        <div class="contact" title="{{customer.electronic_addresses[1].value}}">
            <div>
                <img src="images/icons/phone-icon-small-20x20.png">
            </div><span ng-if="customer.electronic_addresses[1].value">{{customer.electronic_addresses[1].value| tel}}</span> 
            <span ng-if="!customer.electronic_addresses[1].value">Phone not verified</span> 
        </div>
     <!--    <div class="contact">
            <div>
                <img src="images/icons/facebook-icon-small-20x20.png">
            </div> helloitsme
        </div> -->
        <div class="contact" ng-if="customer.external_user_identifiers[0].email" title="{{customer.external_user_identifiers[0].email}}">
            <div title="{{customer.external_user_identifiers[0].email}}">
                <img src="images/icons/mail-icon-small-20x20.png">
            </div>{{customer.external_user_identifiers[0].email | limitTo: 17}}
        </div>
        <div class="contact" ng-if="!customer.external_user_identifiers[0].email">
            <div title="{{customer.external_user_identifiers[0].email}}">
                <img src="images/icons/mail-icon-small-20x20.png">
            </div> Email not verified
        </div>
    </div>
    <div class="clearfix"></div>
    <div class="load-more text-center">
        <button type="button" class="btn btn-purple action " ng-hide="noMoreData || searchIsOn" ng-click="getCustomers(1);"> LOAD MORE </button>
        <button type="button" class="btn btn-purple action" disabled="" ng-show="noMoreData && (!noData) && !searchIsOn"> That's all </button>
    </div>
    <div class="load-more text-center">
        <button type="button" class="btn btn-purple action " ng-hide="noMoreSrchData || !searchIsOn" ng-click="searchCustomers(false,searchkey,1);"> LOAD MORE </button>
        <button type="button" class="btn btn-purple action" disabled="" ng-show="noMoreSrchData && (!noSearchData)"> That's all </button>
    </div>
</div>
</div>

<!-- Sending message to customer-->
<script type="text/ng-template" id="MessageCustomer.html">
    <div class="modal-header add-expert">
        <h3 class="modal-title">Send Message</h3>
        <span></span>
        <hr>
    </div>
    <div class="modal-body">
        <div class="add-expert">
            <!-- <div class="alert alert-success alert-dismissible" role="alert" ng-show="addedGenie">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <strong>Success!</strong> "{{name | uppercase}}" has been added successfully.
            </div> -->
            <div>
            </div>
            <form class="text-center" name="msgCustomer" role="form" novalidate>
               
                <div class="form-group">
                    <label for="expert-address">Write your message here..<sup>*</sup></label>
                    <textarea rows="5" cols="78" ng-model="text" required></textarea>
                </div>
               
                
                <button type="submit" class="btn btn-purple pull-left" ng-click="cancel()">Cancel</a>
                <button type="submit" ng-disabled="msgCustomer.$invalid" class="btn btn-purple pull-right" ng-click="sendSMSCustomer()">Send</button>
                
                <div class="clearfix"></div>
            </form>
        </div>
    </div>
</script>
<!-- Sending message to customer end-->

<!-- Sending Broadcast to Customer-->
    <script type="text/ng-template" id="BroadcastCustomer.html">
        <div class="modal-header add-expert">
            <h3 class="modal-title">Send Broadcast Message To All Customers</h3>
            <span></span>
            <hr>
        </div>
        <div class="modal-body">
            <div class="add-expert">
                <!-- <div class="alert alert-success alert-dismissible" role="alert" ng-show="addedGenie">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <strong>Success!</strong> "{{name | uppercase}}" has been added successfully.
                </div> -->
                <div>
                </div>
                <form class="text-center" name="broadcastCustomer" role="form" novalidate>
                   
                    <div class="form-group">
                        <label for="expert-address">Write your message here..<sup>*</sup></label>
                        <textarea rows="5" cols="78" ng-model="text" required></textarea>
                    </div>
                   
                    
                    <button type="submit" class="btn btn-purple pull-left" ng-click="cancel()">Cancel</a>
                    <button type="submit" ng-disabled="broadcastCustomer.$invalid" class="btn btn-purple pull-right" ng-click="SendBroadcastCustomer()">Send</button>
                    
                    <div class="clearfix"></div>
                </form>
            </div>
        </div>
    </script>
<!-- Sending Broadcast to Customer end-->

